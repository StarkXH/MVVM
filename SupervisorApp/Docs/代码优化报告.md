# SupervisorApp ??????

## ?? ????
??????????????????????????????

## ?? ??????????

### 1. ? ???????????
**??**?RegisterMapViewModel???????? `RaiseCanExecuteChanged()` ??

**????**?
- ?? `CommandManager.cs` ??????????
- ???????????????
- ????????????

**????**?
- ? ???`Core/Common/CommandManager.cs`
- ?? ???`ViewModels/RegisterMapViewModel.cs`
- ?? ???`Core/Common/ViewModelBase.cs`

### 2. ? ?????????
**??**??XAML?????????????????

**????**?
- ?? `ButtonExtensions.xaml` ????????
- ???????????????Excel??????????
- ??UI????????

**????**?
- ? ???`ControlStyle/Themes/ButtonExtensions.xaml`
- ?? ??????XAML????????

### 3. ? ?????????
**??**?MainWindow.xaml.cs??????????try-catch?

**????**?
- ?? `SafeOperationExecutor.cs` ??????
- ????/?????????
- ???????????
- ????????

**????**?
- ? ???`Helpers/SafeOperationExecutor.cs`
- ?? ???`MainWindow.xaml.cs`

### 4. ? ?????????
**??**??????????????

**????**?
- ?? `DeviceFactory.cs` ????
- ?????????????
- ???????????
- ?????????

**????**?
- ? ???`Factories/DeviceFactory.cs`
- ?? ???`MainWindow.xaml.cs`

## ?? ????

### ??????
- **RegisterMapViewModel.cs**: ???30??????????
- **MainWindow.xaml.cs**: ???20??????????
- **??**: ????50+?????

### ??????
- ? ??????????????????
- ? ????????????????
- ? ?????????????????
- ? UI?????????????

### ???????
- ? `CommandManager` ????ViewModel???
- ? `SafeOperationExecutor` ???????????????
- ? `DeviceFactory` ???????????
- ? `ButtonExtensions` ??????XAML???

## ?? ???????

### 1. ??????
?????????????????????????

### 2. ??????
??????????????????

### 3. ????
???????????????????????

### 4. ????
?????????????????????

## ?? ????

### CommandManager ????
```csharp
// ?ViewModel?
private CommandManager _commandManager;

// ????
_commandManager = new CommandManager(this);
_commandManager.AutoRegisterCommands(); // ????????

// ????????
_commandManager.UpdateAllCommandStates();
```

### SafeOperationExecutor ????
```csharp
// ????
SafeOperationExecutor.ExecuteSafely(
    () => SomeOperation(),
    "Operation description",
    showSuccessMessage: true,
    successMessage: "Operation completed!");

// ????
await SafeOperationExecutor.ExecuteSafelyAsync(
    async () => await SomeAsyncOperation(),
    "Async operation description");

// ???????????
SafeOperationExecutor.ExecuteSafelyQuiet(
    () => SomeOperation(),
    "Quiet operation");
```

### DeviceFactory ????
```csharp
// ????????
var device = DeviceFactory.CreateDefaultTestDevice();

// ????????
var device = DeviceFactory.CreateDevice("TestDevice100");

// ???????
DeviceFactory.RegisterDeviceType("MyDevice", () => new MyDevice());
```

## ? ????

- [x] CommandManager ????
- [x] SafeOperationExecutor ??????
- [x] DeviceFactory ??????
- [x] ButtonExtensions ??????
- [x] ??????
- [ ] ???????
- [ ] ??????

---

**??????**: 2024?????
**?????**: GitHub Copilot
**???**: ????????????????????????